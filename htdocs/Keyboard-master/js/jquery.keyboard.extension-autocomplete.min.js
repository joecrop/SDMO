/* jQuery UI Virtual Keyboard Autocomplete v1.6 for Keyboard v1.18+ only (11/19/2014)
 * By Rob Garrison ~ MIT license ~ https://github.com/Mottie/Keyboard */
;(function(b){b.fn.addAutocomplete=function(){return this.each(function(){var a=b(this).data("keyboard");a&&(a.autocomplete_new_version=function(a){a[0]=parseInt(a[0],10);return 1<a[0]||1===a[0]&&9<=parseInt(a[1],10)}(b.ui.version.split(".")),a.autocomplete_init=function(){a.options.alwaysOpen&&a.isVisible()&&a.autocomplete_setup();a.$el.bind("visible.keyboard",function(){a.autocomplete_setup()}).bind("change.keyboard",function(){a.hasAutocomplete&&a.isVisible()&&a.$el.val(a.$preview.val()).trigger("keydown.autocomplete")}).bind("hidden.keyboard", function(){a.$el.autocomplete("close")}).bind("autocompleteopen",function(){a.hasAutocomplete&&a.$autocomplete.menu.element.position({of:a.$keyboard,my:"right top",at:"left top",collision:"flip"})}).bind("autocompleteselect",function(c,b){var d=b.item&&b.item.value||"";a.hasAutocomplete&&""!==d&&(a.$preview.val(d).focus(),a.lastCaret={start:d.length,end:d.length})})},a.autocomplete_setup=function(){a.$autocomplete=a.$el.data("autocomplete")||a.$el.data("uiAutocomplete")||a.$el.data("ui-autocomplete"); a.hasAutocomplete="undefined"===typeof a.$autocomplete?!1:a.$autocomplete.options.disabled?!1:!0;a.hasAutocomplete&&(a.$preview.bind("keydown",function(b){a.$el.val(a.$preview.val()).triggerHandler(b)}),a.$allKeys.bind("mouseup mousedown mouseleave touchstart touchend touchcancel",function(){clearTimeout(a.$autocomplete.searching);a.$autocomplete.searching=setTimeout(function(){a.$autocomplete.term!==a.$autocomplete.element.val()&&(a.$autocomplete.selectedItem=null,a.$autocomplete.search(null,event))}, a.$autocomplete.options.delay)}))},a.origEscClose=a.escClose,a.escClose=function(c){a.hasAutocomplete&&("ui-active-menuitem"===c.target.id||b(c.target).closest("ul").hasClass("ui-autocomplete"))||a.origEscClose(c)},a.autocomplete_init())})}})(jQuery);
